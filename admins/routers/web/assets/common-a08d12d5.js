import{f as i,R as g}from"./index-ea81747c.js";import{U as f}from"./user-1c0de017.js";function h(n){let e=n*24*60*60*1e3,a=i.formatTime(Date.now(),"yyyy-MM-dd"),r=new Date(`${a} 00:00:00`).getTime()-e,s=i.formatTime(r),t=new Date(s).getTime(),u=new Date().getTime()-1*24*60*60*1e3;return{start:t,end:u}}function y(n){let{upMsgs:e,downMsgs:a,disMsgs:r}=n,s=m(e),t=m(a),u=m(r);return{upMsg:s,downMsg:t,disMsg:u}}function m(n){let e=n[0]||{count:0},a=n[1]||{count:1},r=(e.count-a.count)/a.count*100,s=!1;return r>=0&&(s=!0),{isUp:s,percent:Math.abs(r.toFixed(2)),count:i.numberWithCommas(e.count)}}function M(n){let{upMsgs:e,downMsgs:a,disMsgs:r}=n,s=i.map(e,t=>i.formatTime(t.time_mark,"yyyy-MM-dd")).reverse();return e=i.map(e,t=>t.count).reverse(),a=i.map(a,t=>t.count).reverse(),r=i.map(r,t=>t.count).reverse(),{dates:s,upMsgs:e,downMsgs:a,disMsgs:r}}function w(n){let{items:e}=n,a=i.map(e,s=>i.formatTime(s.time_mark,"yyyy-MM-dd")),r=i.map(e,s=>s.count);return{dates:a,daus:r}}function C(n){let e=0;return n.length>0&&(e=n.charCodeAt(0)%6),e}function v(n,e,a){f.getFileToken({app_key:n,file_type:1,ext:"png"}).then(({code:r,data:s})=>{if(!i.isEqual(r,g.SUCCESS))return a(r);S(e,t=>{let{pre_sign_resp:{url:u}}=s,o=new XMLHttpRequest;o.onreadystatechange=function(){i.isEqual(o.readyState,4)&&(u=u.split("?")[0],a(g.SUCCESS,u))},o.open("PUT",u,!0),o.setRequestHeader("Content-Type",""),o.send(t)})})}let S=(n,e,a={})=>{let{scale:r=.2,fileCompressLimit:s=500}=a;n.size/1e3;let t=new Image;t.src=URL.createObjectURL(n),t.onload=function(){u()};var u=function(){var o=document.createElement("canvas");let l=t.height,c=t.width;o.width=c*r,o.height=l*r,o.getContext("2d").drawImage(t,0,0,o.width,o.height),o.toBlob(p=>{var d=new File([p],"tb.png",{type:"image/png"});e(d,{height:l,width:c,type:"image/png"})})}};const D={getRangeDate:h,calcYesterday:y,formatDauChat:w,formatChatData:M,getAvatarNum:C,uploadImage:v};export{D as c};
