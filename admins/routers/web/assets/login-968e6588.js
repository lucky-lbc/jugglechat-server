import{r as w,c as a,y as k,b as t,q as g,v,u as e,t as l,d as m,N as M,p as S,f as i,j as x,ai as E,S as C,a as h,m as T,aj as U,o as d,i as I}from"./index-611f2efb.js";import{U as V}from"./user-7d6fcff1.js";const N={class:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center cim-login-body"},P={class:"container"},$={class:"row justify-content-center"},q={class:"col-lg-6"},B={class:"card-group d-block d-md-flex row"},R={class:"card col-md-7 p-4 mb-0 cim-login-card"},j={class:"card-body"},D={class:"login-input-group mb-3"},K={key:0,class:"invalid-feedback feedback"},L={class:"login-input-group mb-3"},O={key:0,class:"invalid-feedback feedback"},A={class:"login-input-group mb-3"},Y={class:"invalid-feedback feedback login-feedback"},F={__name:"login",setup(G){let f=I();const b=S();let s=w({account:"",password:"",pwdErrorMsg:"",accountErrorMsg:"",loginErrorMsg:"",isSending:!1});function p(){let{account:r,password:o}=s;if(i.isEmpty(r))return s.accountErrorMsg="账号不能为空";if(i.isEmpty(o))return s.pwdErrorMsg="密码不能为空";V.login({account:r,password:o}).then(({code:n,data:c})=>{i.isEqual(n,x.SUCCESS_0.code)&&(c.type=i.isEqual(c.env,"private")?E.PRIVATE:E.PUBLIC,C.set(h.USER_TOKEN,c),f.proxy.$toast({text:"登录成功",icon:"success"}),T.goHomePage(b));let _=U.find(y=>i.isEqual(y.code,n))||{};s.loginErrorMsg=_.msg||"登录失败 "+n})}function u(r){let o={pwd:()=>{s.pwdErrorMsg=""},account:()=>{s.accountErrorMsg=""}};s.loginErrorMsg="",o[r]()}return(r,o)=>(d(),a("div",N,[o[7]||(o[7]=k('<div class="cim-login-banner"><div class="cim-login-sologin"><div class="title">SnailChat 安全通信</div><div class="grap"><p class="content cicon cicon-book">消息安全加密</p><p class="content cicon cicon-product">产品轻量易用</p></div><div class="grap"><p class="content cicon cicon-safe">服务可靠稳定</p><p class="content cicon cicon-rokcet">功能灵活多变</p></div></div></div>',1)),t("div",P,[t("div",$,[t("div",q,[t("div",B,[t("div",R,[t("div",j,[o[6]||(o[6]=t("h1",{class:"cim-login-title"},"登录 SnailChat 后台",-1)),t("div",D,[g(t("input",{class:"form-control",type:"text","onUpdate:modelValue":o[0]||(o[0]=n=>e(s).account=n),placeholder:"账号",onInput:o[1]||(o[1]=n=>u("account"))},null,544),[[v,e(s).account]]),e(s).accountErrorMsg?(d(),a("div",K,l(e(s).accountErrorMsg),1)):m("",!0)]),t("div",L,[g(t("input",{class:"form-control",type:"password","onUpdate:modelValue":o[2]||(o[2]=n=>e(s).password=n),placeholder:"密码",onInput:o[3]||(o[3]=n=>u("pwd")),onKeydown:o[4]||(o[4]=M(n=>p(),["enter"]))},null,544),[[v,e(s).password]]),e(s).pwdErrorMsg?(d(),a("div",O,l(e(s).pwdErrorMsg),1)):m("",!0)]),t("div",A,[t("button",{class:"btn btn-primary cim-login-button",type:"button",onClick:o[5]||(o[5]=n=>p())},"登录")]),t("div",Y,l(e(s).loginErrorMsg),1)])])])])])])]))}};export{F as default};
