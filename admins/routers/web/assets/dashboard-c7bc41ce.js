import{S as k,a as x,r as P,U as N,n as R,c,b as s,u,t as i,d as L,F as S,e as B,A as U,f as a,m as g,g as V,h as $,E as I,o as l,i as K,j as O,k as D}from"./index-611f2efb.js";const H={class:"card-body db-layout"},q={class:"db-contanier"},F={class:"db-apps",ref:"dashApps"},M={key:0,class:"db-app"},W={class:"db-app-header bd-bottom"},Y={class:"db-app-name"},j={class:"db-app"},G={class:"db-app-header bd-bottom"},X={class:"db-app-name"},z={class:"db-app-body"},J={class:"row db-row"},Q={class:"col-md-6 db-right"},Z={class:"row db-row"},ss=["onClick"],ts={class:"row db-row"},es={class:"col-md-6 db-right"},os={class:"row db-row"},ds={class:"col-md-6 db-right"},is={class:"row db-row"},as={class:"col-md-6 db-right"},rs={class:"row db-row"},ns={class:"col-md-6 db-right"},cs={class:"row db-row"},ls={class:"col-md-6 db-right"},_s={class:"db-app-footer bd-top"},ps=["onClick"],us={__name:"dashboard",setup(bs){const _=K();let h=k.get(x.USER_TOKEN),n=P({apps:[]});function E(d){console.log(d)}let p={offset:"",has_more:!0,isAdmin:h.role_type==N.ADMIN};function v(d,t=a.noop){if(!p.has_more)return t(),_.proxy.$toast({icon:"warn",text:"没有更多啦"});U.getList({offset:p.offset}).then(({code:e,data:r})=>{let m=O.USER_TOKEN_EXPIRE;if(a.isEqual(e,m.code))return _.proxy.$toast({icon:"error",text:m.msg}),g.goLoginPage();let{items:w,offset:T,has_more:C}=r;a.extend(p,{offset:T,has_more:C});let f=w.map(o=>(o.created_time=a.formatTime(o.created_time),o.ended_time=o.ended_time==-1?"永久有效":a.formatTime(o.ended_time),o.cur_user_count=a.numberWithCommas(o.cur_user_count),o.max_user_count=a.numberWithCommas(o.max_user_count),o.kind=a.isEqual(o.app_type,V.PRIVATE)?"私有云":"公有云",o));d?n.apps=f:a.forEach(f,o=>{n.apps.push(o)}),t()})}v(!0);function y(d){D.setCurrent(d),g.goBasePage(d)}function A(){$.$emit(I.CREATE_APP)}let b=!0;return R(()=>{let{dashApps:d}=_.refs;d.addEventListener("scroll",()=>{let t=d.scrollTop,e=d.scrollHeight,r=d.getBoundingClientRect().height;e-t-r<50&&b&&(b=!1,v(!1,()=>{b=!0}))})}),(d,t)=>(l(),c("div",H,[s("div",q,[t[7]||(t[7]=s("div",{class:"db-header nav-underline-border"},[s("strong",{class:"db-header-title"},"我的应用")],-1)),s("div",F,[u(n).isAdmin?(l(),c("div",M,[s("div",W,[s("div",Y,i(u(h).is_commercial?"导入应用":"创建应用"),1)]),s("div",{class:"db-app-body db-create-body"},[s("div",{class:"db-app-create cicon cicon-add",onClick:A})])])):L("",!0),(l(!0),c(S,null,B(u(n).apps,e=>(l(),c("div",j,[s("div",G,[s("div",X,i(e.name),1)]),s("div",z,[s("div",J,[t[0]||(t[0]=s("div",{class:"col-md-6 db-left"},"应用名称",-1)),s("div",Q,i(e.app_name),1)]),s("div",Z,[t[1]||(t[1]=s("div",{class:"col-md-6 db-left"},"App-Key",-1)),s("div",{class:"col-md-6 db-right cicon cicon-copy",onClick:r=>E(e.app_key)},i(e.app_key),9,ss)]),s("div",ts,[t[2]||(t[2]=s("div",{class:"col-md-6 db-left"},"创建时间",-1)),s("div",es,i(e.created_time),1)]),s("div",os,[t[3]||(t[3]=s("div",{class:"col-md-6 db-left"},"已注册用户",-1)),s("div",ds,i(e.cur_user_count),1)]),s("div",is,[t[4]||(t[4]=s("div",{class:"col-md-6 db-left"},"授权用户总数",-1)),s("div",as,i(e.max_user_count==-1?"无限制":e.max_user_count),1)]),s("div",rs,[t[5]||(t[5]=s("div",{class:"col-md-6 db-left"},"部署方式",-1)),s("div",ns,i(e.kind),1)]),s("div",cs,[t[6]||(t[6]=s("div",{class:"col-md-6 db-left"},"到期时间",-1)),s("div",ls,i(e.ended_time),1)])]),s("div",_s,[s("a",{class:"btn",onClick:r=>y(e)},"查看明细",8,ps)])]))),256))],512)])]))}};export{us as default};
