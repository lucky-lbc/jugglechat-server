import{L as R,M,f as d,r as T,c as _,b as t,q as x,v as E,u as n,N,F as G,e as L,d as O,p as P,R as w,o as f,l as U,t as h,i as A}from"./index-ea81747c.js";import{_ as F}from"./avatar-8cb183bf.js";import"./common-a08d12d5.js";import"./user-1c0de017.js";function I(m={}){let{limit:i=50,offset:u,app_key:c,group_id:g,keywords:s}=m,y=`${R.GROUP_MANAGER_LIST}?app_key=${c}&group_id=${g}&name=${s}&count=${i}&offset=${u}`;return M(y,{method:"GET"})}function q(m={}){let{group_ids:i,app_key:u}=m,c=`${R.GROUP_MANAGER_DISSOLVE}`;return M(c,{method:"POST",body:d.toJSON({app_key:u,group_ids:i})})}const C={getList:I,dissolve:q},B={class:"mb-4 cim-log-contanier"},K={class:"cim-log-header"},H={class:"cim-log-header-lf-box"},J={class:"cim-log-lf-item"},j={class:"cim-log-lf-item"},z={class:"cim-log-body"},Q={class:"table cim-table"},W={class:"cim-td-c cim-td-group-name"},X={class:"cim-userlist-info"},Y={class:"nickname"},Z={class:"cim-td-c"},tt={class:"cim-td-c"},st={class:"cim-td-c"},et={class:"cim-td-c"},ot={class:"cim-table-tools"},at={class:"cim-table-tool"},it=["onClick"],lt={class:"cim-log-footer"},ct={class:"cim-navigation"},rt={class:"pagination"},nt={class:"page-item"},_t={__name:"grouplist",setup(m){const i=A();let u=P(),{currentRoute:{_rawValue:{params:{app_key:c}}}}=u,g={offset:"",limit:50,app_key:c,group_id:"",keywords:""},s=T({params:d.clone(g),list:[],isFinished:!1});function y(r,o="yyyy-MM-dd"){return d.formatTime(new Date(r).getTime(),o)}function V(r,o){C.dissolve({app_key:c,group_ids:[r.group_id]}).then(e=>{let{code:l,data:b,msg:S=""}=e;d.isEqual(l,w.SUCCESS)?(i.proxy.$toast({icon:"success",text:"群组已解散"}),s.list.splice(o,1)):i.proxy.$toast({icon:"error",text:`Error: ${l} ${S}`})})}function k(){s.params.offset="",v(!0)}function D(){s.params,v(!1)}function v(r){let o={...s.params};C.getList(o).then(e=>{let{code:l,data:b,msg:S=""}=e;if(d.isEqual(l,w.SUCCESS)){let{items:p,offset:$=""}=b;p=d.map(p,a=>(a.statusName=a.status==0?"正常":"已封禁",a.phone=a.phone||"-",a.account=a.account||"-",a.email=a.email||"-",a.time=y(a.created_time,"yyyy-MM-dd hh:mm:ss"),a)),$==""&&(s.isFinished=!0),r?(s.list=p,s.params.offset=""):(s.list=s.list.concat(p),s.params.offset=$)}else i.proxy.$toast({icon:"error",text:`Error: ${l} ${S}`})})}return v(!0),(r,o)=>(f(),_("div",B,[t("div",K,[t("ul",H,[t("li",J,[x(t("input",{class:"form-control",type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>n(s).params.group_id=e),placeholder:"群组 ID",autocomplete:"off",onKeydown:N(k,["enter"])},null,544),[[E,n(s).params.group_id]])]),t("li",j,[x(t("input",{class:"form-control",type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>n(s).params.keywords=e),placeholder:"群组名称",autocomplete:"off",onKeydown:N(k,["enter"])},null,544),[[E,n(s).params.keywords]])]),t("li",{class:"cim-log-lf-item"},[t("div",{class:"cim-button cim-button-bg",onClick:k},"查询")])])]),t("div",z,[t("table",Q,[o[2]||(o[2]=t("thead",null,[t("tr",null,[t("th",{class:"cim-td-c"},"群组名称"),t("th",{class:"cim-td-c"},"群组人数"),t("th",{class:"cim-td-c"},"群组 ID"),t("th",{class:"cim-td-c"},"创建时间"),t("th",{class:"cim-td-c"},"操作")])],-1)),t("tbody",null,[(f(!0),_(G,null,L(n(s).list,(e,l)=>(f(),_("tr",null,[t("td",W,[t("div",X,[U(F,{"user-id":e.group_id,name:e.group_name,avatar:e.group_portrait,cls:"cim-small-avatar"},null,8,["user-id","name","avatar"]),t("div",Y,h(e.group_name),1)])]),t("td",Z,h(e.member_count),1),t("td",tt,h(e.group_id),1),t("td",st,h(e.time),1),t("td",et,[t("ul",ot,[t("li",at,[t("a",{class:"btn-link",href:"#",onClick:b=>V(e,l)},"解散",8,it)])])])]))),256))])])]),t("div",lt,[t("nav",ct,[t("ul",rt,[t("li",nt,[n(s).isFinished?O("",!0):(f(),_("a",{key:0,class:"page-link",href:"#","aria-label":"Next",onClick:D},o[3]||(o[3]=[t("span",{"aria-hidden":"true"},"下一页",-1)])))])])])])]))}};export{_t as default};
