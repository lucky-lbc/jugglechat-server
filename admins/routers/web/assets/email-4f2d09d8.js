import{f as o,W as U,r as q,R as C,c as r,b as l,F as g,e as b,u as _,l as L,p as V,i as A,K as B,o as c,x as F,t as y,d as m}from"./index-0f2e41f6.js";import{R as $,_ as H}from"./dialog-3rd-5862f2a4.js";const I={class:"mb-4 app-base cim-r3-container"},P={class:"cim-r3-body"},z={class:"cim-r3-item"},K={class:"cim-r3-item-header"},M={class:"cim-r3-header-info"},O={class:"cim-r3-item-name"},T={class:"cim-r3-header-status"},W={key:0,class:"life-status"},Y={class:"cim-r3-item-contents"},j={class:"cim-rtc-item-content"},G={key:0,class:"title"},J={key:1,class:"value"},Q={key:2,class:"value unset"},X={class:"cim-r3-item-tools"},Z=["onClick"],ae={__name:"email",setup(ee){let w=V(),{currentRoute:{_rawValue:{params:{app_key:x}}}}=w;const p=A();let S=o.clone(U),f={},n=q({list:[],current:S[0],isShowDialog:!1});function v(i,t){n.isShowDialog=i,i&&(n.current=t)}function D(i){let{uid:t,fields:a}=i,s={},e={};o.forEach(a,u=>{let{key:E,value:d}=u;e[E]=d}),s[t]=e,o.isEqual(B.ENABLE,e.is_used)&&(s.channel=t,o.forEach(n.list,u=>{u.isUsed=o.isEqual(u.uid,t)})),delete s[t].is_used,o.extend(f,s),N(f,s)}function N(i,t){$.setEmail({app_key:x,conf:i}).then(a=>{let{code:s,data:e}=a;if(!o.isEqual(s,C.SUCCESS))return p.proxy.$toast({icon:"error",text:`添加失败: ${s}`});p.proxy.$toast({icon:"success",text:"操作成功"}),k(t),v(!1)})}$.getEmail({app_key:x}).then(i=>{let{code:t,data:a}=i;if(!o.isEqual(t,C.SUCCESS))return p.proxy.$toast({icon:"error",text:`获取配置失败: ${t}`});f=o.clone(a),k(a,!0)});function k(i,t){let{channel:a}=i;o.forEach(S,s=>{let e=o.isEqual(s.uid,a),{uid:u,children:E}=s,d=i[u]||{};o.isEmpty(d)&&!t||(s.children=o.map(E,h=>{let{key:R}=h;return h.value=d[R]||"",h}),e&&(n.current=s),o.extend(s,{isUsed:e}),t&&n.list.push(s))})}return(i,t)=>(c(),r("div",I,[l("ul",P,[(c(!0),r(g,null,b(_(n).list,(a,s)=>(c(),r("li",z,[l("div",K,[l("div",M,[l("div",{class:F(["cim-r3-avatar",[a.icon+"-avatar"]])},null,2),l("div",O,y(a.name),1)]),l("div",T,[a.isUsed?(c(),r("span",W,"【已启用】")):m("",!0)])]),l("ul",Y,[(c(!0),r(g,null,b(a.children,e=>(c(),r("li",j,[e.type=="text"||e.type=="number"?(c(),r("div",G,y(e.name)+":",1)):m("",!0),(e.type=="text"||e.type=="number")&&e.value?(c(),r("div",J,y(e.secretValue||e.value),1)):m("",!0),(e.type=="text"||e.type=="number")&&!e.value?(c(),r("div",Q,"未设置")):m("",!0)]))),256))]),l("ul",X,[l("li",{class:"cim-r3-item-tool cicon wr-update",onClick:e=>v(!0,a)},"设置",8,Z)])]))),256))]),L(H,{show:_(n).isShowDialog,title:"邮箱设置",custom:"邮箱通道",channel:_(n).current,list:_(n).list,onSave:D,onHide:t[0]||(t[0]=a=>v(!1))},null,8,["show","channel","list"])]))}};export{ae as default};
