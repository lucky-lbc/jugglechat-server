import{f as r,V,r as q,R as k,c as l,b as i,F as R,e as g,u as _,l as U,p as B,i as L,K as T,o as c,x as A,t as y,d as h}from"./index-0f2e41f6.js";import{R as b,_ as F}from"./dialog-3rd-5862f2a4.js";const H={class:"mb-4 app-base cim-r3-container"},P={class:"cim-r3-body"},z={class:"cim-r3-item"},I={class:"cim-r3-item-header"},K={class:"cim-r3-header-info"},O={class:"cim-r3-item-name"},Y={class:"cim-r3-item-contents"},j={class:"cim-rtc-item-content"},G={key:0,class:"title"},J={key:1,class:"value"},M={key:2,class:"value unset"},Q={class:"cim-r3-item-tools"},W=["onClick"],te={__name:"rtc",setup(X){let $=B(),{currentRoute:{_rawValue:{params:{app_key:x}}}}=$;const m=L();let S=r.clone(V),p={},o=q({list:[],current:S[0],isShowDialog:!1});function f(n,t){o.isShowDialog=n,n&&(o.current=t)}function w(n){let{uid:t,fields:a}=n,s={},e={};r.forEach(a,u=>{let{key:v,value:d}=u;e[v]=d}),s[t]=e,r.isEqual(T.ENABLE,e.is_used)&&(s.channel=t,r.forEach(o.list,u=>{u.isUsed=r.isEqual(u.uid,t)})),delete s[t].is_used,r.extend(p,s),D(p,s)}function D(n,t){b.setRTC({app_key:x,conf:n}).then(a=>{let{code:s,data:e}=a;if(!r.isEqual(s,k.SUCCESS))return m.proxy.$toast({icon:"error",text:`添加失败: ${s}`});m.proxy.$toast({icon:"success",text:"操作成功"}),C(t),f(!1)})}b.getRTC({app_key:x}).then(n=>{let{code:t,data:a}=n;if(!r.isEqual(t,k.SUCCESS))return m.proxy.$toast({icon:"error",text:`获取配置失败: ${t}`});p=r.clone(a),C(a,!0)});function C(n,t){let{channel:a}=n;r.forEach(S,s=>{let e=r.isEqual(s.uid,a),{uid:u,children:v}=s,d=n[u]||{};r.isEmpty(d)&&!t||(s.children=r.map(v,E=>{let{key:N}=E;return E.value=d[N]||"",E}),e&&(o.current=s),r.extend(s,{isUsed:e}),t&&o.list.push(s))})}return(n,t)=>(c(),l("div",H,[i("ul",P,[(c(!0),l(R,null,g(_(o).list,(a,s)=>(c(),l("li",z,[i("div",I,[i("div",K,[i("div",{class:A(["cim-r3-avatar",[a.icon+"-avatar"]])},null,2),i("div",O,y(a.name),1)]),t[1]||(t[1]=i("div",{class:"cim-r3-header-status"},null,-1))]),i("ul",Y,[(c(!0),l(R,null,g(a.children,e=>(c(),l("li",j,[e.type=="text"||e.type=="number"?(c(),l("div",G,y(e.name)+":",1)):h("",!0),(e.type=="text"||e.type=="number")&&e.value?(c(),l("div",J,y(e.secretValue||e.value),1)):h("",!0),(e.type=="text"||e.type=="number")&&!e.value?(c(),l("div",M,"未设置")):h("",!0)]))),256))]),i("ul",Q,[i("li",{class:"cim-r3-item-tool cicon wr-update",onClick:e=>f(!0,a)},"设置",8,W)])]))),256))]),U(F,{show:_(o).isShowDialog,title:"音视频设置",custom:"音视频通道",channel:_(o).current,list:_(o).list,onSave:w,onHide:t[0]||(t[0]=a=>f(!1))},null,8,["show","channel","list"])]))}};export{te as default};
